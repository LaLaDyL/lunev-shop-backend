<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–í—Ö–æ–¥ | L-U-N-E-V</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
</head>
<body>

<header class="header">
  <div class="header-container">
    <div class="header-left">
      <a href="index.html" class="logo">
        <img src="images/logo1.png" alt="L-U-N-E-V" class="logo-img">
      </a>
    </div>
    <div class="header-right">
      <nav class="nav">
        <a href="favorites.html">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
        <a href="cart.html">üõí –ö–æ—Ä–∑–∏–Ω–∞</a>
        <a href="login.html" class="active">üë§ –í–æ–π—Ç–∏</a>
      </nav>
    </div>
  </div>
</header>

<main class="main-content">
  <div class="auth-container">
    <h2>–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
    
    <form id="login-form" class="auth-form">
      <div class="form-group">
        <input type="email" placeholder="–í–∞—à email" id="email" required>
        <div class="form-error" id="emailError"></div>
      </div>
      
      <div class="form-group">
        <input type="password" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å" id="password" required>
        <div class="form-error" id="passwordError"></div>
      </div>
      
      <button type="submit" class="auth-button" id="submitBtn">
        <span class="btn-text">–í–æ–π—Ç–∏</span>
        <span class="btn-loading" style="display: none;">–í—Ö–æ–¥...</span>
      </button>
    </form>
    
    <p class="auth-link">
      –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="register.html">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
    </p>
  </div>
</main>

<footer class="footer">
  <!-- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ—É—Ç–µ—Ä -->
  <div class="footer-content">
    <div class="footer-section">
      <h3>L-U-N-E-V</h3>
      <p>–ë—É–¥—É—â–µ–µ –ó–¥–µ—Å—å –∏ –°–µ–π—á–∞—Å. –°–∞–º—ã–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –≥–∞–¥–∂–µ—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞.</p>
      <div class="social-links">
        <a href="#"> VK</a>
        <a href="#"> Telegram</a>
        <a href="#"> Twitter</a>
        <a href="#"> YouTube</a>
      </div>
    </div>
    
    <div class="footer-section">
      <h4>–ú–∞–≥–∞–∑–∏–Ω</h4>
      <ul>
        <li><a href="product-telephone.html">–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã</a></li>
        <li><a href="product-consoles.html">–ò–≥—Ä–æ–≤—ã–µ –∫–æ–Ω—Å–æ–ª–∏</a></li>
        <li><a href="product-headphone.html">–ù–∞—É—à–Ω–∏–∫–∏</a></li>
        <li><a href="product-port-consoles.html">–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Å–æ–ª–∏</a></li>
        <li><a href="product-washmashine.html">–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –¥–æ–º–∞</a></li>
      </ul>
    </div>
    
    <div class="footer-section">
      <h4>–ü–æ–º–æ—â—å</h4>
      <ul>
        <li><a href="#">–¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏</a></li>
        <li><a href="#">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</a></li>
        <li><a href="#">–ì–∞—Ä–∞–Ω—Ç–∏—è –∏ –≤–æ–∑–≤—Ä–∞—Ç</a></li>
        <li><a href="#">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</a></li>
        <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </div>
    
    <div class="footer-section">
      <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
      <div class="contact-info">
        <p>üìß Email: MR.ANDREW.BRAUNI@mamamia.ru</p>
        <p>üìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (914) 123-4-88</p>
        <p>üïí –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: 9:00-21:00</p>
        <p>üìç –ê–¥—Ä–µ—Å: –≥. –£–¥–æ–º–ª—è, —É–ª. –ö–æ—Å–º–æ–Ω–∞–≤—Ç–æ–≤, 42</p>
      </div>
    </div>
    
    <div class="footer-section">
      <h4>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h4>
      <div class="security-badges">
        <div>üîí –ó–∞—â–∏—Ç–∞ –µ—Å—Ç—å - –∫–ª—è–Ω—É—Å—å</div>
        <div>üí≥ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ - –º–æ–∂–Ω–æ –∞–≤—à–æ—Ä–∞–º–∏</div>
        <div>üì¶ –ì–∞—Ä–∞–Ω—Ç–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ - 2 –Ω–µ–¥–µ–ª–∏</div>
      </div>
    </div>
  </div>
  
  <div class="footer-bottom">
    <p>¬© 2025 L-U-N-E-V. –ë—É–¥—É—â–µ–µ –ó–¥–µ—Å—å –∏ –°–µ–π—á–∞—Å. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    <div class="footer-links">
      <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
      <a href="#">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
      <a href="#">Cookies</a>
    </div>
  </div>
</footer>

<script>
// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const API_URL = 'https://lunev-shop-backend.onrender.com/api';

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
if (localStorage.getItem('loggedIn') === 'true') {
  window.location.href = 'profile.html';
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function showNotification(message, type = 'error') {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.innerHTML = `
    <div class="notification-content">
      <span>${message}</span>
      <button class="notification-close">&times;</button>
    </div>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => notification.classList.add('show'), 100);
  
  // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
  notification.querySelector('.notification-close').addEventListener('click', () => {
    notification.classList.remove('show');
    setTimeout(() => notification.remove(), 300);
  });
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
  setTimeout(() => {
    if (notification.parentNode) {
      notification.classList.remove('show');
      setTimeout(() => notification.remove(), 300);
    }
  }, 5000);
}

// –ü–æ–∫–∞–∑ –æ—à–∏–±–∫–∏ –ø–æ–ª—è
function showFieldError(fieldId, message) {
  const field = document.getElementById(fieldId);
  const errorElement = document.getElementById(fieldId + 'Error');
  
  if (field && errorElement) {
    field.classList.add('error');
    errorElement.textContent = message;
    errorElement.style.display = 'block';
  }
}

// –°–∫—Ä—ã—Ç–∏–µ –æ—à–∏–±–∫–∏ –ø–æ–ª—è
function hideFieldError(fieldId) {
  const field = document.getElementById(fieldId);
  const errorElement = document.getElementById(fieldId + 'Error');
  
  if (field && errorElement) {
    field.classList.remove('error');
    errorElement.style.display = 'none';
  }
}

// –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
function showLoading() {
  const submitBtn = document.getElementById('submitBtn');
  const btnText = submitBtn.querySelector('.btn-text');
  const btnLoading = submitBtn.querySelector('.btn-loading');
  
  submitBtn.disabled = true;
  btnText.style.display = 'none';
  btnLoading.style.display = 'inline';
}

// –°–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
function hideLoading() {
  const submitBtn = document.getElementById('submitBtn');
  const btnText = submitBtn.querySelector('.btn-text');
  const btnLoading = submitBtn.querySelector('.btn-loading');
  
  submitBtn.disabled = false;
  btnText.style.display = 'inline';
  btnLoading.style.display = 'none';
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
document.getElementById('login-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;
  
  // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫–∏
  hideFieldError('email');
  hideFieldError('password');
  
  let isValid = true;
  
  // –í–∞–ª–∏–¥–∞—Ü–∏—è
  if (!email) {
    showFieldError('email', '–í–≤–µ–¥–∏—Ç–µ email');
    isValid = false;
  } else if (!/\S+@\S+\.\S+/.test(email)) {
    showFieldError('email', '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email');
    isValid = false;
  }
  
  if (!password) {
    showFieldError('password', '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
    isValid = false;
  }
  
  if (!isValid) return;
  
  showLoading();
  
  try {
    const response = await fetch(`${API_URL}/login`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ email, password })
    });
    
    const data = await response.json();
    
    if (data.status === 'success') {
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      localStorage.setItem('loggedIn', 'true');
      localStorage.setItem('currentUser', JSON.stringify(data.user));
      
      showNotification(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${data.user.firstName}!`, 'success');
      
      // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(() => {
        window.location.href = 'index.html';
      }, 1500);
    } else {
      showNotification(data.message || '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
    showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:<br>1. –ó–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä (node server.js)<br>2. –ü–æ—Ä—Ç 3002', 'error');
  } finally {
    hideLoading();
  }
});

// –°–∫—Ä—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ
document.querySelectorAll('#email, #password').forEach(input => {
  input.addEventListener('input', function() {
    hideFieldError(this.id);
  });
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
window.addEventListener('load', async () => {
  try {
    const response = await fetch(`${API_URL}/test`);
    if (response.ok) {
      console.log('‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω');
    }
  } catch (error) {
    console.warn('‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: node server.js');
  }
});
</script>

<script src="js/header.js"></script>
</body>
</html>